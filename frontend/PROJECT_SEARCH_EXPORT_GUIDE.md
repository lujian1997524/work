# 活跃项目搜索和报表导出功能说明

## 功能概述

在活跃项目页面新增了全局搜索按钮和报表导出功能，方便用户快速查找项目信息和导出项目数据。

## 新增功能

### 1. 全局搜索按钮
- **位置**：活跃项目页面统计面板下方的操作工具栏
- **功能**：点击后打开全局搜索模态框，支持跨模块搜索
- **图标**：🔍 放大镜图标
- **快捷键**：Ctrl+K (Windows) / Cmd+K (Mac)

### 2. 报表导出功能
- **位置**：操作工具栏右侧的"导出报表"下拉菜单
- **支持格式**：
  - CSV格式：适合Excel处理和数据分析
  - Excel格式：包含格式化样式，直接可用

### 3. 导出数据内容
报表包含以下字段：
- 项目编号
- 项目名称
- 状态（待处理/进行中/已完成）
- 优先级（低/普通/中等/高/紧急）
- 分配工人
- 创建者
- 总板材数
- 已完成板材
- 进行中板材
- 待处理板材
- 完成率
- 图纸数量
- 创建日期
- 项目描述

## 使用方法

### 搜索项目
1. 点击活跃项目页面的"全局搜索"按钮
2. 在搜索框中输入关键词
3. 系统会搜索项目名称、描述、工人姓名等信息
4. 点击搜索结果可直接跳转到对应项目

### 导出报表
1. 在活跃项目页面找到操作工具栏
2. 点击"导出报表"按钮，会显示下拉菜单
3. 选择导出格式：
   - "导出为 CSV"：生成CSV文件
   - "导出为 Excel"：生成Excel文件
4. 文件会自动下载到浏览器默认下载目录

## 文件命名规则
- CSV文件：`活跃项目报表_YYYY-MM-DD.csv`
- Excel文件：`活跃项目报表_YYYY-MM-DD.xls`

## 技术特点

### 1. 响应式设计
- 桌面端：显示完整按钮文字
- 移动端：只显示图标，节省空间
- 触摸友好的交互设计

### 2. 数据完整性
- 自动计算材料进度统计
- 处理空值和缺失数据
- 中文标题和格式化

### 3. 用户体验
- 悬停显示下拉菜单
- Toast提示导出结果
- 禁用状态处理（无项目时）

## 文件位置

### 新增文件
- `utils/projectReportExporter.ts` - 报表导出工具

### 修改文件
- `components/projects/ActiveProjectsCardView.tsx` - 活跃项目视图组件
- `app/page.tsx` - 主页面，添加搜索回调

## 浏览器兼容性
- 支持所有现代浏览器
- 文件下载功能基于HTML5标准
- CSV格式包含BOM，支持中文显示

## 注意事项
1. 导出功能需要项目数据加载完成
2. 大量项目数据可能影响导出性能
3. Excel格式使用HTML表格方式，兼容性较好
4. 搜索功能依赖全局搜索模态框组件